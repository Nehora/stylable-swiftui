name: CI

on: [push]

jobs:
 test:
    runs-on: macOS-latest
    steps:
    - uses: actions/checkout@master
    - name: Switch XCode Version
      run: sudo xcode-select -s /Applications/Xcode_11.app
    - name: Test StylableSwiftUI
      shell: bash
      run: |
        cd Example
        set -o pipefail && xcodebuild test -enableCodeCoverage YES -workspace StylableSwiftUI.xcworkspace -scheme StylableSwiftUI-Example ONLY_ACTIVE_ARCH=NO CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO -destination 'platform=iOS Simulator,name=iPhone 11,OS=13.0' | xcpretty --color
        cd ..
        pod lib lint --allow-warnings
